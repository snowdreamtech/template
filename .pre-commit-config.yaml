---
# Pre-commit hook configuration (local mode).
# Uses system-installed tools directly — no network downloads required.
#
# Required tools (install once):
#   brew install yamllint shellcheck actionlint hadolint shfmt gitleaks
#   pip3 install ansible-lint
#   npm install -g markdownlint-cli2 prettier editorconfig-checker cspell eslint
#
# Setup (one-time per machine):
#   pip3 install pre-commit
#   pre-commit install
#
# Run manually against all files:
#   pre-commit run --all-files

repos:
  - repo: local
    hooks:
      # ── Secret Scanning ────────────────────────────────────────────────────
      - id: gitleaks
        name: gitleaks
        language: system
        entry: gitleaks protect --verbose --redact --staged
        pass_filenames: false

      # ── YAML ──────────────────────────────────────────────────────────────
      - id: yamllint
        name: yamllint
        language: system
        entry: yamllint
        args: [--config-file, .yamllint.yml]
        types: [yaml]

      # ── Markdown ───────────────────────────────────────────────────────────
      - id: markdownlint-cli2
        name: markdownlint-cli2
        language: system
        entry: markdownlint-cli2
        args: [--fix]
        types: [markdown]

      # ── JSON / YAML / Vue / React / JS / TS formatting ───────────────────────────
      - id: prettier
        name: prettier
        language: system
        entry: prettier
        args: [--write]
        types_or: [json, yaml, vue, javascript, jsx, ts, tsx]

      # ── EditorConfig ───────────────────────────────────────────────────────
      - id: editorconfig-checker
        name: editorconfig-checker
        language: system
        entry: editorconfig-checker
        args:
          - -exclude
          - "(\\.(venv|git|github/agents|agent|agents|roo|claude|qwen|amazonq|augment|bob|codebuddy|codex|kilocode|opencode|qoder|shai|cursor|windsurf|pearai|pi|pochi|specify|supermaven|tabnine|trae|vibe|void|zed|zencoder|openhands|cody|coderabbit|aide|cline|clinerules|cursorrules|pr_agent.toml|tabnine|supermaven|vibe|void|zed)/.*)|((node_modules|venv|env|dist|build|out|target|vendor|__pycache__|\\.specify/scripts)/.*)|(\\.aider\\.conf\\.yml)"
        pass_filenames: false

      # ── Spell Checker ──────────────────────────────────────────────────────
      - id: cspell
        name: cspell
        language: system
        entry: cspell
        args: [--no-progress, --no-summary, --dot]
        types: [text]

      # ── Go ─────────────────────────────────────────────────────────────────
      - id: golangci-lint
        name: golangci-lint
        language: system
        entry: golangci-lint
        args: [run, --fix]
        types: [go]
        pass_filenames: false

      # ── Rust ─────────────────────────────────────────────────────────────────
      - id: cargo-fmt
        name: cargo fmt
        language: system
        entry: cargo fmt
        types: [rust]
        pass_filenames: false

      - id: cargo-clippy
        name: cargo clippy
        language: system
        entry: cargo clippy --fix --allow-dirty --allow-staged
        types: [rust]
        pass_filenames: false

      # ── Python ───────────────────────────────────────────────────────────────
      - id: ruff
        name: ruff check
        language: system
        entry: ruff check --fix
        types_or: [python, pyi]

      - id: ruff-format
        name: ruff format
        language: system
        entry: ruff format
        types_or: [python, pyi]

      # ── Dart / Flutter ───────────────────────────────────────────────────────
      - id: dart-format
        name: dart format
        language: system
        entry: dart format
        types: [dart]

      - id: dart-analyze
        name: dart analyze
        language: system
        entry: dart analyze --fatal-infos
        types: [dart]
        pass_filenames: false

      # ── Apple Ecosystem (Swift / Obj-C) ──────────────────────────────────────
      - id: swiftformat
        name: swiftformat
        language: system
        entry: swiftformat
        types: [swift]

      - id: swiftlint
        name: swiftlint
        language: system
        entry: swiftlint --fix
        types: [swift]
        pass_filenames: false

      - id: clang-format
        name: clang-format
        language: system
        entry: clang-format -i
        types_or: [objective-c, c, c++]

      # ── Android Ecosystem (Kotlin / Java) ──────────────────────────────────
      - id: ktlint
        name: ktlint
        language: system
        entry: ktlint --format
        types: [kotlin]
        pass_filenames: true

      - id: google-java-format
        name: google-java-format
        language: system
        entry: google-java-format --replace
        types: [java]
        pass_filenames: true

      # ── JavaScript / TypeScript / Vue / React ───────────────────────────────────
      - id: eslint
        name: eslint
        language: system
        entry: eslint
        args: [--fix]
        types_or: [javascript, jsx, ts, tsx, vue]

      # ── Shell Scripts ──────────────────────────────────────────────────────
      - id: shellcheck
        name: shellcheck
        language: system
        entry: shellcheck
        types: [shell]

      - id: shfmt
        name: shfmt
        language: system
        entry: shfmt
        args: [-w, -s, -l]
        types: [shell]

      # ── GitHub Actions Workflows ───────────────────────────────────────────
      - id: actionlint
        name: actionlint
        language: system
        entry: actionlint
        files: ^\.github/workflows/.*\.yml$
        pass_filenames: false

      # ── Ansible ────────────────────────────────────────────────────────────
      - id: ansible-lint
        name: ansible-lint
        language: system
        entry: ansible-lint
        pass_filenames: false
        files: \.(yml|yaml)$

      # ── Dockerfile ─────────────────────────────────────────────────────────
      - id: hadolint
        name: hadolint
        language: system
        entry: hadolint
        files: Dockerfile
